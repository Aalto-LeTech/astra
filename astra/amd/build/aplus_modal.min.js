define(["jquery","core/event","mod_astra/aplus_highlightcode","theme_boost/dropdown","theme_boost/modal"],function(l,t){return function(i,t,e,n){var s="aplusModal",o={loader_selector:".modal-progress",loader_text_selector:".progress-bar",title_selector:".modal-title",content_selector:".modal-body",error_message_attribute:"data-msg-error"};function r(t,e){this.element=i(t),this.settings=i.extend({},o,e),this.init()}i.extend(r.prototype,{init:function(){this.loader=this.element.find(this.settings.loader_selector),this.loaderText=this.loader.find(this.settings.loader_text_selector),this.title=this.element.find(this.settings.title_selector),this.content=this.element.find(this.settings.content_selector),this.messages={loading:this.loaderText.text(),error:this.loaderText.attr(this.settings.error_message_attribute)}},run:function(t,e){switch(t){case"open":this.open(e);break;case"error":this.showError(e);break;case"content":this.showContent(e)}},open:function(t){this.title.hide(),this.content.hide(),this.loaderText.removeClass("bg-danger").addClass("progress-bar-animated").text(t||this.messages.loading),this.loader.show(),this.element.on("hidden.bs.modal",function(t){i(".dropdown-toggle").dropdown()}),this.element.modal("show")},showError:function(t){this.loaderText.removeClass("progress-bar-animated").addClass("bg-danger").text(t||this.messages.error)},showContent:function(t){return this.loader.hide(),t.title&&(this.title.text(t.title),this.title.show()),t.content instanceof l?this.content.empty().append(t.content):this.content.html(t.content),this.content.show(),this.content}}),i.fn[s]=function(e,n,o){return this.each(function(){var t=i.data(this,"plugin_"+s);return t||(t=new r(this,o),i.data(this,"plugin_"+s,t)),t.run(e,n)})}}(l,window,document),function(l,a,t,e,n){var o="aplusModalLink",i={modal_selector:"#page-modal",file_modal_selector:"#file-modal",body_regexp:/<body[^>]*>([\s\S]*)<\/body>/i,file:!1};function s(t,e){this.element=l(t),this.settings=l.extend({},i,e),this.init()}l.extend(s.prototype,{init:function(){var s=this.element,r=this.settings;s.on("click",function(t){t.preventDefault();var e=s.attr("href");if(""===e||"#"==e)return!1;var i=l(r.file?r.file_modal_selector:r.modal_selector);i.aplusModal("open"),l.get(e,function(t){if(r.file){var e=l("<pre/>").text(t);i.aplusModal("content",{title:s.text(),content:e}),e.highlightCode()}else{var n=t.match(r.body_regexp);null!==n&&2==n.length&&(t=n[1]);var o=i.aplusModal("content",{content:t});o.find(".file-modal").aplusModalLink({file:!0}),o.find("pre.hljs").highlightCode(),a.notifyFilterContentUpdated(r.modal_selector)}}).fail(function(){i.aplusModal("error")})})}}),l.fn[o]=function(t){return this.each(function(){l.data(this,"plugin_"+o)||l.data(this,"plugin_"+o,new s(this,t))})}}(l,t,window,document),{}});