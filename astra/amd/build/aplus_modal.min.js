define(["jquery","core/event","mod_astra/aplus_highlightcode","theme_boost/dropdown","theme_boost/modal"],function(t,e){return function(e,n,o,i){var s={loader_selector:".modal-progress",loader_text_selector:".progress-bar",title_selector:".modal-title",content_selector:".modal-body",error_message_attribute:"data-msg-error"};function l(t,n){this.element=e(t),this.settings=e.extend({},s,n),this.init()}e.extend(l.prototype,{init:function(){this.loader=this.element.find(this.settings.loader_selector),this.loaderText=this.loader.find(this.settings.loader_text_selector),this.title=this.element.find(this.settings.title_selector),this.content=this.element.find(this.settings.content_selector),this.messages={loading:this.loaderText.text(),error:this.loaderText.attr(this.settings.error_message_attribute)}},run:function(t,e){switch(t){case"open":this.open(e);break;case"error":this.showError(e);break;case"content":this.showContent(e)}},open:function(t){this.title.hide(),this.content.hide(),this.loaderText.removeClass("bg-danger").addClass("progress-bar-animated").text(t||this.messages.loading),this.loader.show(),this.element.on("hidden.bs.modal",function(t){e(".dropdown-toggle").dropdown()}),this.element.modal("show")},showError:function(t){this.loaderText.removeClass("progress-bar-animated").addClass("bg-danger").text(t||this.messages.error)},showContent:function(e){return this.loader.hide(),e.title&&(this.title.text(e.title),this.title.show()),e.content instanceof t?this.content.empty().append(e.content):this.content.html(e.content),this.content.show(),this.content}}),e.fn.aplusModal=function(t,n,o){return this.each(function(){var i=e.data(this,"plugin_aplusModal");return i||(i=new l(this,o),e.data(this,"plugin_aplusModal",i)),i.run(t,n)})}}(t,window,document),function(t,e,n,o,i){var s={modal_selector:"#page-modal",file_modal_selector:"#file-modal",body_regexp:/<body[^>]*>([\s\S]*)<\/body>/i,file:!1};function l(e,n){this.element=t(e),this.settings=t.extend({},s,n),this.init()}t.extend(l.prototype,{init:function(){var n=this.element,o=this.settings;n.on("click",function(i){i.preventDefault();var s=n.attr("href");if(""===s||"#"==s)return!1;var l=t(o.file?o.file_modal_selector:o.modal_selector);l.aplusModal("open"),t.get(s,function(i){if(o.file){var s=t("<pre/>").text(i);l.aplusModal("content",{title:n.text(),content:s}),s.highlightCode()}else{var r=i.match(o.body_regexp);null!==r&&2==r.length&&(i=r[1]);var a=l.aplusModal("content",{content:i});a.find(".file-modal").aplusModalLink({file:!0}),a.find("pre.hljs").highlightCode(),e.notifyFilterContentUpdated(o.modal_selector)}}).fail(function(){l.aplusModal("error")})})}}),t.fn.aplusModalLink=function(e){return this.each(function(){t.data(this,"plugin_aplusModalLink")||t.data(this,"plugin_aplusModalLink",new l(this,e))})}}(t,e,window,document),{}});