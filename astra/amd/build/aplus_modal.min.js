define(["jquery","core/event","mod_astra/aplus_highlightcode","theme_bootstrapbase/bootstrap"],function(a,b){return function(b,c,d,e){function f(a,c){this.element=b(a),this.settings=b.extend({},h,c),this.init()}var g="aplusModal",h={loader_selector:".modal-progress",loader_text_selector:".progress-bar",title_selector:".modal-title",content_selector:".modal-body",error_message_attribute:"data-msg-error"};b.extend(f.prototype,{init:function(){this.loader=this.element.find(this.settings.loader_selector),this.loaderText=this.loader.find(this.settings.loader_text_selector),this.title=this.element.find(this.settings.title_selector),this.content=this.element.find(this.settings.content_selector),this.messages={loading:this.loaderText.text(),error:this.loaderText.attr(this.settings.error_message_attribute)}},run:function(a,b){switch(a){case"open":this.open(b);break;case"error":this.showError(b);break;case"content":this.showContent(b)}},open:function(a){this.title.hide(),this.content.hide(),this.loaderText.removeClass("progress-bar-danger").addClass("active").text(a||this.messages.loading),this.loader.show(),this.element.on("hidden.bs.modal",function(a){b(".dropdown-toggle").dropdown()}),this.element.modal("show")},showError:function(a){this.loaderText.removeClass("active").addClass("progress-bar-danger").text(a||this.messages.error)},showContent:function(b){return this.loader.hide(),b.title&&(this.title.text(b.title),this.title.show()),b.content instanceof a?this.content.empty().append(b.content):this.content.html(b.content),this.content.show(),this.content}}),b.fn[g]=function(a,c,d){return this.each(function(){var e=b.data(this,"plugin_"+g);return e||(e=new f(this,d),b.data(this,"plugin_"+g,e)),e.run(a,c)})}}(a,window,document),function(a,b,c,d,e){function f(b,c){this.element=a(b),this.settings=a.extend({},h,c),this.init()}var g="aplusModalLink",h={modal_selector:"#page-modal",file_modal_selector:"#file-modal",body_regexp:/<body[^>]*>([\s\S]*)<\/body>/i,file:!1};a.extend(f.prototype,{init:function(){var c=this.element,d=this.settings;c.on("click",function(e){e.preventDefault();var f=c.attr("href");if(""===f||"#"==f)return!1;var g=a(d.file?d.file_modal_selector:d.modal_selector);g.aplusModal("open"),a.get(f,function(e){if(d.file){var f=a("<pre/>").text(e);g.aplusModal("content",{title:c.text(),content:f}),f.highlightCode()}else{var h=e.match(d.body_regexp);null!==h&&2==h.length&&(e=h[1]);var i=g.aplusModal("content",{content:e});i.find(".file-modal").aplusModalLink({file:!0}),i.find("pre.hljs").highlightCode(),b.notifyFilterContentUpdated(d.modal_selector)}}).fail(function(){g.aplusModal("error")})})}}),a.fn[g]=function(b){return this.each(function(){a.data(this,"plugin_"+g)||a.data(this,"plugin_"+g,new f(this,b))})}}(a,b,window,document),{}});