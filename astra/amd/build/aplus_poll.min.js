define(["jquery"],function(t){return function(t,e,s,i){var a="aplusExercisePoll",n={poll_url_attr:"data-poll-url",ready_url_attr:"data-ready-url",poll_delays:[2,3,5,5,5,10,10,10,10],message_selector:".progress-bar",message_attr:{error:"data-msg-error",timeout:"data-msg-timeout"}};function l(e,s,i){this.element=t(e),this.callback=s,this.settings=t.extend({},n,i),this.url=null,this.count=0,this.init()}t.extend(l.prototype,{init:function(){this.element.show(),this.url=this.element.attr(this.settings.poll_url_attr),this.schedule()},poll:function(e){var s=this;t.ajax(this.url,{dataType:"html"}).fail(function(){s.message("error")}).done(function(t){s.count++,"ready"===t.trim()||"error"===t.trim()||"unofficial"===t.trim()?s.ready():s.element.is(":visible")&&(s.count<s.settings.poll_delays.length?s.schedule():s.message("timeout"))})},schedule:function(){var t=this;setTimeout(function(){t.poll()},1e3*this.settings.poll_delays[this.count])},ready:function(){t.data(this.element.get(0),"plugin_"+a)&&t.removeData(this.element.get(0),"plugin_"+a);var s=this.element.attr(this.settings.ready_url_attr);this.callback?this.callback(s):e.location=s},message:function(e){if(this.element.find(this.settings.message_selector).removeClass("progress-bar-animated").text(this.element.attr(this.settings.message_attr[e])),this.element.data("aplus-active-element")){var s="There was an error while evaluating the element.";"timeout"==e&&(s="Evaluation was timed out.");var i=this.element.find(".ae_result").text(s);0===i.height()&&i.height("auto"),t.data(this.element.get(0),"plugin_"+a)&&t.removeData(this.element.get(0),"plugin_"+a)}else"error"==e&&this.element.find(this.settings.message_selector).addClass("bg-danger")}}),t.fn[a]=function(e,s){return this.each(function(){t.data(this,"plugin_"+a)||t.data(this,"plugin_"+a,new l(this,e,s))})},t.aplusExerciseDetectWaits=function(e,s){t(s=s||".exercise-wait").aplusExercisePoll(e)}}(t,window,document),{}});