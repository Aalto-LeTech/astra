/**
 * A+ table row filter as an AMD module for Moodle.
 * In an HTML page, run the following JS code once to activate it:
 * $('.filtered-table').aplusTableFilter();
 * 
 * Source: A+ (a-plus/assets/js/aplus.js)
 * License: GNU GPL v3
 * 
 * @module mod_astra/aplus_tablefilter
 */
define(["jquery"],function(a){return function(a,b,c,d){"use strict";function e(b,c){this.element=a(b),this.filters=null,this.timeout=null,"TABLE"==this.element.prop("tagName")&&(this.settings=a.extend({},g,c),this.init())}var f="aplusTableFilter",g={};a.extend(e.prototype,{init:function(){var b=0;this.element.find("thead").find("tr").each(function(){var c=a(this).find("th").size();b=c>b?c:b});var c=this,d=function(b){var d=a(this);clearTimeout(c.timeout),c.timeout=setTimeout(function(){c.filterColumn(d)},500)};this.filters=[];for(var e=a("<tr></tr>"),f=0;b>f;f++){this.filters.push("");var g=a('<input type="text" data-column="'+f+'">').on("keyup",d).on("change",d),h=a("<td></td>");h.append(g),e.append(h)}this.element.find("thead").append(e)},filterColumn:function(a){var b=a.attr("data-column"),c=a.val();this.filters[b]=c.trim(),this.filterTable()},filterTable:function(){var b=this;this.element.find("tbody").find("tr").hide().filter(function(){var c=!0;return a(this).find("td").each(function(d){return b.filters[d]&&a(this).text().toLowerCase().indexOf(b.filters[d].toLowerCase())<0?(c=!1,!1):void 0}),c}).show()}}),a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(a,window,document),{}});